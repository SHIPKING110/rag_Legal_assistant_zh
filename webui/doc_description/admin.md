# 管理员面板使用说明

## 登录管理员账号

使用以下凭据登录管理员面板：

- **用户名**: `root`
- **密码**: `123456`

## 功能模块

### 📊 系统概览

系统概览页面显示以下统计信息：

- **总用户数**: 系统中注册的用户总数
- **总会话数**: 所有用户创建的会话总数
- **总消息数**: 系统中的消息总数
- **数据大小**: 系统数据占用的磁盘空间

此外还会显示：
- 最近注册的用户列表
- 用户基本信息预览

### 👥 用户管理

用户管理页面提供以下功能：

- **查看所有用户**: 显示系统中所有注册用户的列表
- **搜索用户**: 通过用户名或邮箱搜索特定用户
- **查看用户详情**: 点击"查看会话"按钮可以查看用户的所有会话
- **分页显示**: 每页显示20个用户，支持翻页浏览

用户信息包括：
- 用户ID
- 用户名
- 邮箱
- 注册时间
- 最后登录时间

### 💬 会话查看

会话查看页面允许管理员：

- **查看用户会话列表**: 显示选定用户的所有聊天会话
- **查看对话内容**: 点击"查看对话内容"按钮可以查看完整的对话历史
- **只读访问**: 管理员只能查看，不能修改用户的聊天内容

会话信息包括：
- 会话ID
- 会话标题
- 创建时间
- 更新时间
- 消息数量

对话内容显示：
- 用户消息（蓝色背景）
- 助手回复（绿色背景）
- 每条消息的时间戳

### 🚪 退出登录

点击"退出登录"按钮可以安全退出管理员账号，系统会：

- 清除所有管理员会话状态
- 重定向到登录页面
- 确保管理员权限被正确撤销

## 安全说明

⚠️ **重要提示**：

1. 管理员账号拥有系统最高权限，请妥善保管登录凭据
2. 管理员可以查看所有用户的聊天记录，请遵守隐私保护原则
3. 建议定期修改管理员密码（需要修改代码中的密码哈希值）
4. 所有管理员操作都会被记录到审计日志中

## 技术细节

### 密码修改

如需修改管理员密码，请按以下步骤操作：

1. 打开 `webui/admin.py` 文件
2. 找到 `AdminManager` 类
3. 修改 `ADMIN_PASSWORD_HASH` 常量

生成新密码哈希的方法：

```python
import hashlib
new_password = "your_new_password"
password_hash = hashlib.sha256(new_password.encode()).hexdigest()
print(password_hash)
```

### 数据存储

管理员面板从以下位置读取数据：

- 用户信息: `./rag_falv_data/users.json`
- 用户数据目录: `./rag_falv_data/users/{user_id}/`
- 会话数据: `./rag_falv_data/users/{user_id}/chat_data/*.json`

## 常见问题

**Q: 忘记管理员密码怎么办？**

A: 管理员密码硬编码在 `webui/admin.py` 文件中，默认为 `123456`。如果修改后忘记，可以查看代码或重新设置密码哈希。

**Q: 可以创建多个管理员账号吗？**

A: 当前版本只支持一个管理员账号（root）。如需支持多个管理员，需要修改代码实现。

**Q: 管理员可以删除用户吗？**

A: 当前版本的管理员面板主要用于查看和监控，删除用户功能已在代码中实现但未在UI中启用。如需启用，可以取消相关按钮的注释。

**Q: 如何查看管理员操作日志？**

A: 管理员操作会记录到审计日志中，但当前版本未在UI中显示。日志文件位于 `./rag_falv_data/admin_audit.log`。
